!function e(t,n,o){function a(i,c){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!c&&l)return l(i,!0);if(r)return r(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var s=n[i]={exports:{}};t[i][0].call(s.exports,function(e){var n=t[i][1][e];return a(n?n:e)},s,s.exports,e,t,n,o)}return n[i].exports}for(var r="function"==typeof require&&require,i=0;i<o.length;i++)a(o[i]);return a}({1:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var a=e("./controllers/DonationCtrl"),r=o(a),i=e("./controllers/CheckoutCtrl"),c=o(i),l=e("./controllers/PaymentCompletedCtrl"),u=o(l),s=e("./services/DonationService"),f=o(s);angular.module("chancletagithubioApp",["ngResource","ngRoute","ngStorage","angularPayments","timer"]).controller("DonationCtrl",r["default"]).controller("CheckoutCtrl",c["default"]).controller("PaymentCompletedCtrl",u["default"]).service("DonationService",f["default"]).config(["$routeProvider","$httpProvider",function(e,t){e.when("/",{templateUrl:"views/donationForm.html",controller:"DonationCtrl",controllerAs:"donation"}).when("/checkout",{templateUrl:"views/checkoutForm.html",controller:"CheckoutCtrl",controllerAs:"checkout"}).when("/paymentCompleted",{templateUrl:"views/paymentCompleted.html",controller:"PaymentCompletedCtrl",controllerAs:"completed"}).otherwise({redirectTo:"/"}),t.interceptors.push(["$q","$location","$localStorage",function(e,t,n){return{request:function(e){return e.headers=e.headers||{},e.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",e}}}])}]).constant("ConfigData",{url:"https://test.oppwa.com/v1/payments",authData:{"authentication.userId":"8a8294174b7ecb28014b9699220015cc","authentication.password":"sy6KJsT8","authentication.entityId":"8a8294174b7ecb28014b9699220015ca"},paymentType:"DB"}).run(["DonationService","$location","$rootScope",function(e,t,n){n.$on("$routeChangeStart",function(n,o,a){"views/paymentCompleted.html"!=o.templateUrl?e.isUserAllowedToDonate()||t.path("/paymentCompleted"):e.isUserAllowedToDonate()&&t.path("/"),e.getRemainingTimeUntilNextDonation()<=0&&e.restoreDonation()})}])},{"./controllers/CheckoutCtrl":2,"./controllers/DonationCtrl":3,"./controllers/PaymentCompletedCtrl":4,"./services/DonationService":6}],2:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(t,n,a){o(this,e),t.donationData().isValid()||n.path("/"),this.donationService=t,this.paymentInfo={},this.isRequestActive=!1,this.location=n,this.localStorage=a}return e.$inject=["DonationService","$location","$localStorage"],a(e,[{key:"performCheckout",value:function(e){var t=this;e.$valid||Materialize.toast("Please verify the fields and try again.",5e3,"error");var n=function(e){t.isRequestActive=!1,Materialize.toast("Oops Something went wrong while contacting the server, please verify the fields and try again.",5e3,"error")},o=function(e){Materialize.toast("Donation successfully completed!!!",5e3,"success"),t.isRequestActive=!1,t.localStorage.paymentInfo=e,t.localStorage.paymentInfo.paidOnTimeStamp=(new Date).getTime(),t.location.path("/paymentCompleted")};this.isRequestActive=!0,this.donationService.performPayment(this.paymentInfo,o,n)}}]),e}();n["default"]=r,t.exports=n["default"]},{}],3:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=e("../models/DonationModel"),c=o(i),l=function(){function e(t,n){a(this,e),this.donateData={},this.DonationService=n,this.location=t,this.currencyOptions=c["default"].currencyOptions,this.donateData.currency=this.currencyOptions[0].val}return e.$inject=["$location","DonationService"],r(e,[{key:"donate",value:function(e){if(!e.$valid)return void Materialize.toast("Please verify the fields and try again.",5e3,"error");var t=this.donateData;return this.currencyOptions.some(function(e){return t.currency==e.val})?isNaN(parseFloat(this.donateData.amount))||this.donateData.amount>100||this.donateData.amount<0?void Materialize.toast("Please type a valid amount, cannot be greater than 100 and lower than 0.",5e3,"error"):(this.DonationService.saveDonationData(this.donateData),void this.location.path("/checkout")):void Materialize.toast("Please select a valid currency.",5e3,"error")}}]),e}();n["default"]=l,t.exports=n["default"]},{"../models/DonationModel":5}],4:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(t,n,a){var r=this;o(this,e),this.endTime=a.getPaymentInformation().paidOnTimeStamp+36e5,this.isUserAllowedToDonate=a.isUserAllowedToDonate(),this.donationService=a,this.location=t,this.scope=n,this.paymentInformation=a.getPaymentInformation();var i=function(e,t){r.donationService.restoreDonation(),r.isUserAllowedToDonate=!0,r.scope.$apply()};this.scope.$on("timer-stopped",i)}return e.$inject=["$location","$scope","DonationService"],a(e,[{key:"redirect",value:function(){this.location.path("/")}}]),e}();n["default"]=r,t.exports=n["default"]},{}],5:[function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){o(this,e),this.amount="",this.currency=""}return a(e,[{key:"isValid",value:function(){var t=this.currency;return e.currencyOptions.some(function(e){return t==e.val})?!(isNaN(parseFloat(this.amount))||this.amount>100||this.amount<0):!1}}],[{key:"currencyOptions",get:function(){return[{val:"EUR",label:"EUR"},{val:"USD",label:"USD"}]}}]),e}();n["default"]=r,t.exports=n["default"]},{}],6:[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=e("../models/DonationModel"),c=o(i),l=function(){function e(t,n,o){a(this,e),this.resource=t(n.url),this.donationDataObject=new c["default"],this.configData=n,this.localStorage=o}return e.$inject=["$resource","ConfigData","$localStorage"],r(e,[{key:"donationData",value:function(){return this.donationDataObject}},{key:"saveDonationData",value:function(e){this.donationDataObject.amount=e.amount,this.donationDataObject.currency=e.currency}},{key:"performPayment",value:function(e,t,n){var o={};o["card.expiryMonth"]=e.expiry.split("/")[0],o["card.expiryYear"]=e.expiry.split("/")[1],o["card.number"]=e.card.number,o["card.cvv"]=e.card.cvv,o=$.extend(o,this.configData.authData),o=$.extend(o,this.donationDataObject),o.paymentType=this.configData.paymentType,this.resource.save({},$.param(o)).$promise.then(function(e){e.id?t(e):n(e)})["catch"](function(e){n(e)})}},{key:"getRemainingTimeUntilNextDonation",value:function(){return"undefined"==typeof this.localStorage.paymentInfo?-1:3600-((new Date).getTime()-this.localStorage.paymentInfo.paidOnTimeStamp)/1e3}},{key:"isUserAllowedToDonate",value:function(){return"undefined"==typeof this.localStorage.paymentInfo?!0:this.getRemainingTimeUntilNextDonation()<=0}},{key:"restoreDonation",value:function(){delete this.localStorage.paymentInfo}},{key:"getPaymentInformation",value:function(){return this.localStorage.paymentInfo}}]),e}();n["default"]=l,t.exports=n["default"]},{"../models/DonationModel":5}]},{},[1]);
//# sourceMappingURL=app.min.js.map
